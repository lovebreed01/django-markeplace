 {% extends 'market/base.html' %}
 {% load humanize %}

{% block title %}
    Sell  and Buy used and new Products
{% endblock title %}

{% block contents %}
<div id="cont">
    {% if request.user == item.seller and request.user.is_authenticated %}
        <i>Is this item already purchased ? <a class="btn btn-danger" href="{% url 'delete' item.slug %}">Delete item </a></i>
    	
    {% endif%}
    <br><br>
    <p class="lead">{{item.category}}</p>
    <h1 >{{item.title | upper}}</h1>
     <i >Posted  {{item.created | naturaltime}}</i>
    <div id="details-cont">
        <div id="img-cont">
             <div class="container">
  
                
                  <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
  <ol class="carousel-indicators">
    {% for img in images %}
    <li data-target="#carouselExampleIndicators" data-slide-to="{{forloop.counter}}" class="active"></li>
    {% endfor %}
    
  </ol>
  <div class="carousel-inner">
    <div class="carousel-item active ">
      <img src="{{item.get_first_img.url}}" class="d-block w-100" alt="...">
    </div>    
    {% for img in images %}
    <div class="carousel-item ">
      <img src="{{img.files.url}}" class="d-block w-100" alt="...">
    </div>
    {% endfor %}
    </div>
  <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>
      
            </div>


            
        </div>
        <!-- Second div element -->
        <div class="item-details-cont">
                <div id="seller-name">Seller : {{item.seller}}</div><br>

                <strong id="price">Price : #{{item.price | intcomma}}</strong><br>
                <p><strong>Description</strong> : <br>{{item.description}}</p>

                <a class="btn btn-primary" id="phone" href="tel:{{item.seller.profile.phone_number}}">

                    Call Seller Now
                </a>
                <button id="showbtn" class=" btn btn-secondary">Send Message</button>
                <form action="" method="POST" id="msg-form">
                    {% csrf_token %}
                    {{messageform}}
                    <button class="btn-green">Drop Message</button>
                </form>
    

        </div>
      
    </div>
<br>
  
<!-- The dots/circles -->

         

        

    </div>
   <h4>Related items </h4>
   <div id="related">
    {% for item  in related %}
    <div class="item-cont">
        <img src="{{item.get_first_img.url}}"
                     alt="">
        <a href="{% url 'details' item.slug %}">
            <span>{{item.title}}</span>
            <b style="float:right;">#{{item.price | intcomma}}</b>
        </a>
    </div>
    {% endfor %}
    
   </div>   

</div>
    
    
{% endblock contents %}

{% block scripts  %}
    <script>
        const showbtn = document.querySelector('#showbtn')

        showbtn.addEventListener('click', (e)=>{
            let form = document.querySelector('#msg-form')
            form.style.display = 'block'
            document.querySelector('#msg-input').focus()
            e.target.style.display = 'none'

        })
        var slideIndex = 0;
showSlides(); // call showslide method
   
function showSlides()
{
    var i;
  
    // get the array of divs' with classname image-sliderfade
    var slides = document.getElementsByClassName("image-sliderfade"); 
      
    // get the array of divs' with classname dot
    var dots = document.getElementsByClassName("dot"); 
  
    for (i = 0; i < slides.length; i++) {
        // initially set the display to 
        // none for every image.
        slides[i].style.display = "none"; 
    }
    // for(let i = 0,i< dots.length; i++){
    //     dots[i].onclick = ()=>{
    //         slides[i].style.display = 'block'
    //     }
    // }
   
     // increase by 1, Global variable
    slideIndex++; 
   
     // check for boundary
    if (slideIndex > slides.length) 
    {
        slideIndex = 1;
    }
   
    for (i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.
                            replace(" active", "");
    }
   
    slides[slideIndex - 1].style.display = "block";
    dots[slideIndex - 1].className += " active";
  
    // Change image every 2 seconds
    setTimeout(showSlides, 4000); 
}
    </script>
{% endblock scripts  %}
